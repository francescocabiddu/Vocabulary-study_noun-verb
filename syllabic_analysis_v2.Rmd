---
title: 'Paper 1: results (syllabic analysis, v2)'
output:
  word_document:
    reference_docx: template1.docx
  pdf_document: default

---

Date: `r Sys.Date()` 

<!-- loading packages, user-defined functions and datasets -->
```{r echo=FALSE, warning=FALSE, message=FALSE, cache=FALSE, include=FALSE}
lib <- c("tidyverse","kableExtra", 
         "knitr")
lapply(lib, require, character.only = TRUE)
load(file="ws.RData")

options(knitr.table.format = 'markdown')
```

<!-- set folder for graphs -->
```{r opts, echo = FALSE}
knitr::opts_chunk$set(
  fig.path = "images/"
)
```

<br>

###  Average number of "mother's monosyllabic types" contained in "mother's bisyllabic noun types" (bisyllabic nouns learned by the children" and "not learned by the children")

```{r echo=FALSE}
summary_bis[["id"]] %>% round_df(2) %>% kable()
```

<br>

### Same as above, but over time (only including those monosyllabic types that occurred in previous stages, up to current stage)

```{r echo=FALSE}
summary_bis[["id_stage"]] %>% round_df(2) %>% kable()
```

<br>

### Same as above, but considering monosyllabic tokens instead of types, in order to account for the frequency of the models (e.g. in the case of "table" [t + ey + bull], the frequency of "bull" in the maternal corpus could influence the probability of using the monosyllabic "bull" to build "table")

```{r echo=FALSE}
summary_bis[["id_stage_tokens"]] %>% round_df(2) %>% kable()
```

<br>

### Average number of 2-phoneme, 3-phoneme, 4-phoneme and 5-phoneme 'models' (tokens considered) there are in the input up until current stage.

<br>

#### BISYLLABIC NOUNS

<br>

##### Mothers' bisyllabic nouns learned by the child

```{r echo=FALSE}
summary_seq_tokens_learned %>% round_df(2) %>% kable()
```

<br>

##### Mothers' bisyllabic nouns NOT learned by the child

```{r echo=FALSE}
summary_seq_tokens_not_learned %>% round_df(2) %>% kable()
```

<br>

##### Paired t test to compare Average number of 'models' in learned and not-learned bisyllabic nouns

```{r echo=FALSE}
tests <- list(t.test(summary_seq_tokens_learned$mean_seq2[1:12],
                 summary_seq_tokens_not_learned$mean_seq2[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_learned$mean_seq3[1:12],
                 summary_seq_tokens_not_learned$mean_seq3[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_learned$mean_seq4[1:12],
                 summary_seq_tokens_not_learned$mean_seq4[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_learned$mean_seq5[1:12],
                 summary_seq_tokens_not_learned$mean_seq5[1:12],
                 paired = TRUE))

tibble(Avg_difference = c("2-phoneme", "3-phoneme", "4-phoneme", "5-phoneme"),
       t_statistic = sapply(tests, function(x) {x$statistic}) %>% round(2),
       p_value = sapply(tests, function(x) {x$p.value}) %>% round(3),
       `confint_95%` = sapply(tests, function(x) {paste(round(x$conf.int, 2), collapse = " , ")})) %>%
  kable()
```

<br>

```{r echo=FALSE, fig.width=8, fig.height=4.5, message=FALSE, warning=FALSE}
long_summary <- function(df, set_label) {
  df %>%
    .[1:12,] %>%
    gather(sequence, Mean, mean_seq2:mean_seq5) %>%
    mutate(Sequence = str_replace(sequence, "^mean_seq", ""),
           Set = set_label)
}

summary_seq_tokens_learned %>%
  long_summary(" Learned") %>%
  rbind(summary_seq_tokens_not_learned %>%
          long_summary(" Not learned")) %>%
  filter(Sequence %in% c("4", "5")) %>%
  ggplot(aes(x=Sequence, y=Mean, fill=Set)) +
  stat_summary(fun.y="mean", geom="bar", position=position_dodge(width=0.95))+
  stat_summary(geom = "errorbar", 
               fun.data = mean_se, position = position_dodge(width=0.95),
               width=0.2) +
  scale_fill_grey(start=0.8, end=0.45) +
  theme(legend.title=element_blank()) +
  ylab("Mean number of models")
```

**Figure .** Mean and standard errors of number of 4-phoneme and 5-phoneme 'models' in learned and not-learned bisyllabic nouns

<br>

#### Phoneme calculation repeated for Mothers' MONOSYLLABIC nouns.

<br>

##### Mothers' monosyllabic nouns learned by the child

```{r echo=FALSE}
summary_seq_tokens_mono_learned %>% round_df(2) %>% kable()
```

<br>

##### Mothers' monosyllabic nouns NOT learned by the child

```{r echo=FALSE}
summary_seq_tokens_mono_not_learned %>% round_df(2) %>% kable()
```

<br>

##### Paired t test to compare Average number of 'models' in learned and not-learned MONOSYLLABIC nouns

```{r echo=FALSE}
tests <- list(t.test(summary_seq_tokens_mono_learned$mean_seq2[1:12],
                 summary_seq_tokens_mono_not_learned$mean_seq2[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_mono_learned$mean_seq3[1:12],
                 summary_seq_tokens_mono_not_learned$mean_seq3[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_mono_learned$mean_seq4[1:12],
                 summary_seq_tokens_mono_not_learned$mean_seq4[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_mono_learned$mean_seq5[1:12],
                 summary_seq_tokens_mono_not_learned$mean_seq5[1:12],
                 paired = TRUE))

tibble(Avg_difference = c("2-phoneme", "3-phoneme", "4-phoneme", "5-phoneme"),
       t_statistic = sapply(tests, function(x) {x$statistic}) %>% round(2),
       p_value = sapply(tests, function(x) {x$p.value}) %>% round(3),
       `confint_95%` = sapply(tests, function(x) {paste(round(x$conf.int, 2), collapse = " , ")})) %>%
  kable()
```

<br>

#### Phoneme calculation repeated for Mothers' TRISYLLABIC nouns.

<br>

##### Mothers' trisyllabic nouns learned by the child

```{r echo=FALSE}
summary_seq_tokens_tri_learned %>% round_df(2) %>% kable()
```

<br>

##### Mothers' trisyllabic nouns NOT learned by the child

```{r echo=FALSE}
summary_seq_tokens_tri_not_learned %>% round_df(2) %>% kable()
```

<br>

##### Paired t test to compare Average number of 'models' in learned and not-learned TRISYLLABIC nouns

```{r echo=FALSE}
tests <- list(t.test(summary_seq_tokens_tri_learned$mean_seq2[1:12],
                 summary_seq_tokens_tri_not_learned$mean_seq2[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_tri_learned$mean_seq3[1:12],
                 summary_seq_tokens_tri_not_learned$mean_seq3[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_tri_learned$mean_seq4[1:12],
                 summary_seq_tokens_tri_not_learned$mean_seq4[1:12],
                 paired = TRUE),
          t.test(summary_seq_tokens_tri_learned$mean_seq5[1:12],
                 summary_seq_tokens_tri_not_learned$mean_seq5[1:12],
                 paired = TRUE))

tibble(Avg_difference = c("2-phoneme", "3-phoneme", "4-phoneme", "5-phoneme"),
       t_statistic = sapply(tests, function(x) {x$statistic}) %>% round(2),
       p_value = sapply(tests, function(x) {x$p.value}) %>% round(3),
       `confint_95%` = sapply(tests, function(x) {paste(round(x$conf.int, 2), collapse = " , ")})) %>%
  kable()
```

<br>

```{r echo=FALSE, fig.width=8, fig.height=4.5, message=FALSE, warning=FALSE}
long_summary <- function(df, set_label) {
  df %>%
    .[1:12,] %>%
    gather(sequence, Mean, mean_seq2:mean_seq5) %>%
    mutate(Sequence = str_replace(sequence, "^mean_seq", ""),
           Set = set_label)
}

summary_seq_tokens_tri_learned %>%
  long_summary(" Learned") %>%
  rbind(summary_seq_tokens_tri_not_learned %>%
          long_summary(" Not learned")) %>%
  filter(Sequence %in% c("4", "5")) %>%
  ggplot(aes(x=Sequence, y=Mean, fill=Set)) +
  stat_summary(fun.y="mean", geom="bar", position=position_dodge(width=0.95))+
  stat_summary(geom = "errorbar", 
               fun.data = mean_se, position = position_dodge(width=0.95),
               width=0.2) +
  scale_fill_grey(start=0.8, end=0.45) +
  theme(legend.title=element_blank()) +
  ylab("Mean number of models")
```

**Figure .** Mean and standard errors of number of 4-phoneme and 5-phoneme 'models' in learned and not-learned trisyllabic nouns
